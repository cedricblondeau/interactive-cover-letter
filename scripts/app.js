var CoverLetter={settings:{assistScrolling:!1,clouds:3,ships:3,stars:50},init:function(){this.emitBackgroundElements(),this.scenesCount=$("#scenes-container .scene").length,this.enableScrollMagic(),this.settings.assistScrolling&&this.scrollify()},emitBackgroundElements:function(){this.emitStars(),this.emitMovingElements($("#clouds"),"cloud",this.settings.clouds),this.emitMovingElements($("#ships"),"ship",this.settings.ships,{speed:120,minTopPosition:-30,maxTopPosition:20})},emitStars:function(){for(var e=$("#stars"),t=0,n=0;n<this.settings.stars;n++)t=Math.floor(t+100/this.settings.stars),$('<div class="star"></div>').css({left:t+"%",top:5+Math.floor(30*Math.random())+"%"}).appendTo(e)},emitMovingElements:function(e,t,n,o){o=o||{};var i={speed:60,minTopPosition:0,maxTopPosition:30};$.extend(o,i);for(var s=0,a=0;a<n;a++){s=Math.floor(s+100/n);var l=$('<div class="'+t+'"></div>').css({left:s+"%",top:o.minTopPosition+Math.floor(Math.random()*o.maxTopPosition)+"%",opacity:0}).appendTo(e),r=new TimelineMax({paused:!0,repeat:-1}).set(l,{left:"0"}).to(l,1,{opacity:1}).to(l,o.speed,{left:"100%",ease:Linear.easeNone},0),c=o.speed*((100-s)/100);(new TimelineMax).to(l,1,{opacity:1}).to(l,c,{left:"100%",ease:Linear.easeNone},0).to(l,.5,{opacity:0}).add(r.play())}},enableScrollMagic:function(){TweenMax.to($(".bubble"),0,{scale:0});var e=new ScrollMagic.Controller;this.moveSunOnScroll(e),this.sunsetOnScroll(e),this.displayBubblesOnScroll(e)},moveSunOnScroll:function(e){new ScrollMagic.Scene({triggerElement:"#scenes-container",duration:100*this.scenesCount+"%",triggerHook:"onLeave"}).setTween(TweenMax.to("#sun",1,{right:"100%"})).addTo(e),new ScrollMagic.Scene({triggerElement:"#scenes-container",duration:100*(this.scenesCount-1)+"%",triggerHook:"onLeave"}).setTween((new TimelineMax).to("#sun",1,{bottom:"60%"}).to("#sun",1,{bottom:"10%"})).addTo(e)},sunsetOnScroll:function(e){new ScrollMagic.Scene({triggerElement:"#scene-"+this.scenesCount,triggerHook:"onLeave"}).setTween((new TimelineMax).to("#sun",.25,{opacity:0}).set("#moon",{visibility:"visible"}).set("#stars",{visibility:"visible"}).to("#sky",.5,{backgroundColor:"#2e4482"}).to("#water",.5,{backgroundColor:"#011825"},0).to("#skyline-windows",.5,{fill:"#ecbe68"},0).to($("#clouds"),.5,{opacity:0},0).to("#stars",1,{opacity:1},"-=0.5").to("#moon",1,{opacity:1},"-=1.5")).addTo(e)},displayBubblesOnScroll:function(e){for(var t=1;t<=this.scenesCount;t++)new ScrollMagic.Scene({triggerElement:"#scene-"+t,triggerHook:"onLeave"}).setTween(TweenMax.to("#bubble-"+t,.5,{scale:1,ease:Elastic.easeInOut})).addTo(e),new ScrollMagic.Scene({triggerElement:"#scene-"+t,duration:"100%",triggerHook:"onLeave"}).setTween((new TimelineMax).to("#bubble-"+t,1,{opacity:1}).to("#bubble-"+t,1,{opacity:0})).addTo(e)},scrollify:function(){$.scrollify({section:".scene",scrollSpeed:800,offset:10,scrollbars:!0,overflowScroll:!0,easing:"easeInCubic",before:function(e,t){$(".pagination-marker").removeClass("active"),$("#pagination-marker-"+(e+1)).addClass("active")},afterRender:function(){var e='<nav id="pagination"><ul>',t="";$(".scene").each(function(n){t="",0===n&&(t="active"),e+='<li class="pagination-marker '+t+'" id="pagination-marker-'+(n+1)+'"><span></span></li>'}),e+="</ul></nav>",$("body").append(e)}})}};$(document).ready(function(){CoverLetter.settings.assistScrolling=!0,CoverLetter.init()});